# RFC-0017

# Semantic Type Inference Engine v1.0

## Formal Inference Rules for Civic and Closure Typing

Status: Draft
Depends on: RFC-0014

---

# 1. Purpose

Defines formal inference rules allowing the Portal to:

* Infer types for tokens
* Validate CivicTriples
* Enforce Closure typing
* Detect semantic category violations

Inference must be deterministic and local.

---

# 2. Judgement Form

Typing judgement:

```
Γ ⊢ e : T
```

Where:

* Γ = type environment
* e = expression (token, triple, closure)
* T = inferred type

---

# 3. Base Inference Rules

### (NOUN)

```
token ∈ NOUN
—————————————
Γ ⊢ token : Entity
```

---

### (VERB)

```
token ∈ VERB
—————————————
Γ ⊢ token : Relation
```

---

### (COLLECTIVE)

```
token ∈ collective_lexicon
—————————————
Γ ⊢ token : Collective
```

---

### (WITNESS)

```
token == commit
—————————————
Γ ⊢ token : Witness
```

---

# 4. Triple Typing Rule

### (TRIPLE)

```
Γ ⊢ s : Entity
Γ ⊢ p : Relation
Γ ⊢ o : Collective
—————————————————————————
Γ ⊢ (s,p,o) : CivicTriple
```

---

# 5. Closure Typing Rule

### (CLOSURE)

```
closure.face = predicate
Γ ⊢ closure.synsets ⊆ Relation
—————————————————————————
Γ ⊢ closure : Closure
```

---

# 6. Subtyping

```
Collective <: Entity
Witness <: Entity
```

Subtyping is transitive and reflexive.

---

# 7. Inference Algorithm

Deterministic left-to-right parsing:

```
for token in sentence:
    assign lexical type
    propagate subtyping
    validate triple pattern
```

No backtracking allowed in v1.0.

---

# 8. Type Error Emission

If inference fails:

```json
{
  "type":"type_error",
  "token":"shall",
  "expected":"Relation",
  "found":"Modal"
}
```

---

# 9. Soundness Theorem

If Γ ⊢ e : T, then execution of e cannot produce value outside T.

---

# 10. Completeness Constraint

All CivicTriples emitted by RFC-0012 must satisfy inference rules in RFC-0017.
