# RFC-0022

# Multi-World Extension & Shard Merging Theory v1.0

## Formal Model of Basis Forking and Reconciliation

Status: Draft
Depends on: RFC-0010, RFC-0020

---

# 1. Purpose

Defines how semantic worlds:

* Fork
* Extend
* Merge
* Remain isolated

Without losing determinism.

---

# 2. World Definition

A world W defined as:

```id="mw1"
W = (basisHash, registry_hash, ledger L)
```

---

# 3. Fork Operation

Fork creates:

```id="mw2"
W' = (basisHash', registry_hash', L_prefix)
```

L_prefix is prefix of L.

Fork must increment basis version.

---

# 4. Shard

Shard defined by:

```id="mw3"
w âˆˆ [0,1]
```

Worlds may diverge in specific shard ranges.

---

# 5. Merge Preconditions

Two worlds W_A, W_B mergeable iff:

```id="mw4"
basisHash compatible
registry_hash compatible
```

Compatibility means:

* identical canon OR
* mapped via federation Î¦

---

# 6. Merge Algorithm

```id="mw5"
L_merge = L_A âˆª L_B
I_merge = ð“œ(L_merge)
```

Recompute independent set.

If circuits exceed threshold â†’ merge fails.

---

# 7. Conflict Resolution Hierarchy

Prefer events with:

1. Valid proof
2. Lower drift
3. Earlier logical time
4. Higher trust weight

---

# 8. Shard Isolation

Worlds may isolate shards:

```id="mw6"
restrict w âˆˆ [a,b]
```

Projection ignores other shards.

---

# 9. Multi-World Graph

Worlds form DAG:

```id="mw7"
nodes = worlds
edges = fork or merge
```

No cycles allowed in merge graph.

---

# 10. Canon Drift Barrier

If basisHash differs semantically:

Worlds must not merge.

Only federation allowed.

---

# 11. Merge Invariant

> Merging worlds must preserve replay determinism.

---

# 12. World Identity Hash

```id="mw8"
worldHash = sha256(basisHash + registry_hash + ledger_hash)
```

---

# 13. Theoretical Result

Multi-world structure forms:

* A partially ordered set under prefix relation
* With matroid-consistent merges
