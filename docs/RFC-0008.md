# RFC-0008

# Semantic Drift Metric v1.0

## Formal Distance Function for SynsetRPC Resolution

Status: Draft
Depends on: RFC-0002, RFC-0005

---

# 1. Purpose

Defines a deterministic metric `D` measuring semantic drift between:

* requested_coord
* resolved_coord
* synset sets
* intent tags

Drift governs:

* closure selection
* matroid independence
* replay determinism

---

# 2. Coordinate Drift

Coordinates are 4D:

```id="n1"
c = (x, y, z, w) ∈ [0,1]^4
```

Primary drift:

```id="n2"
D_coord(a, b) = √[(xa-xb)^2 + (ya-yb)^2 + (za-zb)^2 + λ(w_a-w_b)^2]
```

Where:

* λ = w-weight coefficient (default = 2.0)

This weights shard misalignment more heavily.

---

# 3. Synset Drift

Let:

```id="n3"
S_a, S_b = synset sets
```

Use Jaccard distance:

```id="n4"
D_synset = 1 - |S_a ∩ S_b| / |S_a ∪ S_b|
```

---

# 4. Intent Drift

Intent tags treated as categorical sets:

```id="n5"
D_intent = 1 - overlap_ratio
```

---

# 5. Composite Drift

Final drift:

```id="n6"
D_total = αD_coord + βD_synset + γD_intent
```

Default weights:

| Component  | Weight |
| ---------- | ------ |
| Coordinate | 0.5    |
| Synset     | 0.3    |
| Intent     | 0.2    |

---

# 6. Drift Thresholds

| Context                | Max Drift |
| ---------------------- | --------- |
| synset_reply accept    | ≤ 0.15    |
| closure_resolve commit | ≤ 0.10    |
| federation accept      | ≤ 0.20    |

---

# 7. Drift Invariant

> For fixed inputs, D_total MUST be deterministic and identical across implementations.

---

# 8. Numerical Stability

* Floating point must use fixed precision (6 decimal places)
* Round after each component
* No implicit type coercion

---

# 9. Drift Reporting

Each synset_reply MUST include:

```json
{
  "drift": 0.084321
}
```

---

# 10. Geometric Interpretation

Drift defines a tolerance sphere in semantic space.

Closure acceptance = point lies within drift ball.
